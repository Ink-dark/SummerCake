name: "ğŸš€ æ¨é€é€šçŸ¥åˆ°ä¼ä¸šå¾®ä¿¡"

on: [push] # è§¦å‘æ¡ä»¶ï¼šå½“æœ‰ä»£ç æ¨é€æ—¶

jobs:
  notify-wechat:
    name: å‘é€ä¼ä¸šå¾®ä¿¡é€šçŸ¥
    runs-on: ubuntu-latest
    steps:
      # ç¬¬ä¸€æ­¥ï¼šæ‰“å°ä¸ªæ—¥å¿—ï¼Œæ–¹ä¾¿è°ƒè¯•
      - name: æ£€æŸ¥æ¨é€äº‹ä»¶
        run: echo "äº‹ä»¶ç”± ${{ github.actor }} è§¦å‘ï¼Œæäº¤ä¿¡æ¯æ˜¯ ${{ github.event.head_commit.message }}"

      # ç¬¬äºŒæ­¥ï¼šæ ¸å¿ƒæ­¥éª¤ - ä½¿ç”¨ curl å‘½ä»¤ç›´æ¥å‘é€ Markdown æ¶ˆæ¯
      - name: å‘é€ Markdown æ¶ˆæ¯åˆ°ä¼ä¸šå¾®ä¿¡
        run: |
          curl -s -H "Content-Type: application/json" \
          -X POST \
          -d '{
            "msgtype": "markdown",
            "markdown": {
              "content": "**SummerCake Git GUI æœ‰æ–°çš„ä»£ç æäº¤ï¼**\n\n---\n> **å˜åŠ¨ä»“åº“ï¼š** <font color=\"info\">${{ github.repository }}</font>\n> **æäº¤è€…ï¼š** <font color=\"comment\">${{ github.actor }}</font>\n> **å˜åŠ¨åˆ†æ”¯ï¼š** `${{ github.ref_name }}`\n> **ç›¸å…³æäº¤ä¿¡æ¯ï¼š** \n> ${{ github.event.head_commit.message }}\n\n[ğŸ“± ç‚¹å‡»è¿™é‡Œå¯ä»¥æŸ¥çœ‹æäº¤è¯¦æƒ…](${{ github.event.head_commit.url }})",
              "mentioned_list": [
                "@all"
              ]
            }
          }' \
          "${{ secrets.WECHAT_QIYE_WEBHOOK_KEY }}"
